input RegisterCompetitorInput {
    first_name: String!
    last_name: String!
    email: Email!
    guests: [String!]!
    is_interested_in_nations_cup: Boolean!
    events: [ID!]
    days: [ID!]
}

input CreateCompetitorInput {
    first_name: String!
    last_name: String!
    email: Email!
    wca_id: WcaId!
    nationality: String!
    gender: String!
    registration_status: RegistrationStatus
    payment_status: PaymentStatus
    guests: [String!]!
    is_interested_in_nations_cup: Boolean!
    event_ids: [ID!]
    day_ids: [ID!]
}

input UpdateCompetitorInput {
    id: ID!
    first_name: String
    last_name: String
    email: Email
    nationality: String
    gender: String
    guests: [String!]
    is_interested_in_nations_cup: Boolean
    event_ids: [ID!]
    day_ids: [ID!]
}

input UpdateRegistrationInput {
    competition_id: ID!
    first_name: String
    last_name: String
    email: Email
    nationality: String
    gender: String
    guests: [String!]
    is_interested_in_nations_cup: Boolean
    event_ids: [ID!]
    day_ids: [ID!]
}

type RegistrationReceipt {
    registration_id: ID!
    first_name: String!
    last_name: String!
    wca_id: WcaId!
    email: Email!
}

type Competitor {
    id: ID!
    first_name: String!
    last_name: String!
    wca_id: WcaId!
    email: Email! @guard @can(ability: "manage", model: "Competitor", query: true)
    avatar: String
    gender: String! @guard @can(ability: "manage", model: "Competitor", query: true)
    guests: [String!] @guard @can(ability: "manage", model: "Competitor", query: true)
    number_of_guests: Int! @rename(attribute: "numberOfGuests")
    registration_status: RegistrationStatus!
    payment_status: PaymentStatus! @guard @can(ability: "manage", model: "Competitor", query: true)
    has_podium_potential: Boolean!
    events: [Event!]! @belongsToMany
    days: [Day!]! @belongsToMany @guard @can(ability: "manage", model: "Competitor", query: true)
    nationality: String!
    is_eligible_for_prizes: Boolean!
    is_interested_in_nations_cup: Boolean!
    finances: FinancialBook! @guard @can(ability: "manage", model: "Competitor", query: true)
    created_at: DateTime!
    updated_at: DateTime
}

extend type Query {
    competitors(
        events: [ID!]
        days: [ID!]
        is_eligible_for_prizes: Boolean @eq
        registration_status: RegistrationStatus @eq
        wca_id: WcaId @eq
        competition_id: ID @eq
    ): [Competitor!]! @paginate
    competitor(id: ID!): Competitor @find
}

extend type Mutation {
    registerCompetitor(input: RegisterCompetitorInput @spread): RegistrationReceipt
        @guard
    updateRegistration(input: UpdateRegistrationInput @spread): Competitor
        @update
        @guard
        @can(ability: "manage")
    createCompetitor(input: CreateCompetitorInput @spread): Competitor
        @create
        @guard
        @can(ability: "crud")
    updateCompetitor(input: UpdateCompetitorInput @spread): Competitor
        @update
        @guard
        @can(ability: "crud")
    deleteCompetitor(id: ID!): Competitor
        @delete
        @guard
        @can(ability: "crud")
}

